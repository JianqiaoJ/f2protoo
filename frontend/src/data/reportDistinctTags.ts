/**
 * 可选 tag 基于 mtgdata/数据文件字段分析报告.md 中 raw.tsv 的「各 distinct tag 对应歌曲数量」，
 * 不限制数量：所有出现过的 tag 均展示，每类按歌曲数量倒序排列。
 * 乐器类另合并 详细Tags分析报告 中 autotagging_instrument.tsv 的 41 个 tag，未在 raw 中出现的计 0 首。
 */

export const GENRES_WITH_COUNT: [string, number][] = [
  ["ambient", 7073],
  ["electronic", 6999],
  ["classical", 4504],
  ["alternative", 3678],
  ["easylistening", 2934],
  ["pop", 2580],
  ["chillout", 2420],
  ["dance", 2216],
  ["folk", 1376],
  ["hiphop", 1265],
  ["blues", 880],
  ["soundtrack", 805],
  ["indie", 787],
  ["rock", 770],
  ["jazz", 691],
  ["atmospheric", 633],
  ["funk", 630],
  ["experimental", 612],
  ["poprock", 551],
  ["orchestral", 547],
  ["metal", 503],
  ["club", 500],
  ["instrumentalpop", 473],
  ["country", 440],
  ["downtempo", 433],
  ["dancehall", 383],
  ["newage", 373],
  ["reggae", 335],
  ["breakbeat", 334],
  ["80s", 312],
  ["90s", 307],
  ["drumnbass", 305],
  ["instrumentalrock", 304],
  ["electropop", 282],
  ["acidjazz", 275],
  ["celtic", 272],
  ["darkambient", 267],
  ["dubstep", 261],
  ["dub", 255],
  ["hardrock", 243],
  ["chanson", 240],
  ["latin", 203],
  ["house", 199],
  ["fusion", 193],
  ["punk", 192],
  ["70s", 190],
  ["60s", 179],
  ["ethno", 179],
  ["8bit", 158],
  ["disco", 152],
  ["popfolk", 151],
  ["hardcore", 148],
  ["heavymetal", 147],
  ["baroque", 144],
  ["deephouse", 136],
  ["alternativerock", 132],
  ["darkwave", 132],
  ["choir", 131],
  ["classicrock", 128],
  ["grunge", 128],
  ["bossanova", 126],
  ["trance", 118],
  ["ambiant", 117],
  ["acid", 115],
  ["african", 112],
  ["industrial", 112],
  ["hard", 111],
  ["world", 109],
  ["progressive", 105],
  ["ethnicrock", 93],
  ["asian", 92],
  ["americana", 79],
  ["techno", 79],
  ["improvisation", 76],
  ["flamenco", 75],
  ["gothic", 74],
  ["avantgarde", 73],
  ["chansonfrancaise", 73],
  ["ebm", 73],
  ["acidhouse", 72],
  ["psychedelic", 69],
  ["rap", 66],
  ["garage", 65],
  ["gangstarap", 64],
  ["electrohouse", 63],
  ["edm", 60],
  ["deathmetal", 57],
  ["minimal", 56],
  ["lounge", 55],
  ["powerpop", 53],
  ["christian", 50],
  ["newwave", 50],
  ["bluesrock", 48],
  ["death", 47],
  ["eletronica", 46],
  ["choral", 43],
  ["hardstyle", 43],
  ["groove", 38],
  ["postrock", 38],
  ["synthpop", 38],
  ["chiptune", 37],
  ["triphop", 37],
  ["artrock", 36],
  ["cabaret", 36],
  ["electrorock", 36],
  ["dancepop", 35],
  ["ambiente", 32],
  ["rnb", 30],
  ["eurodance", 29],
  ["minimaltechno", 29],
  ["singersongwriter", 29],
  ["gospel", 27],
  ["minimalism", 27],
  ["acidrock", 24],
  ["bebop", 24],
  ["guitarrock", 23],
  ["jazzfunk", 23],
  ["oriental", 22],
  ["blackmetal", 21],
  ["lofi", 21],
  ["score", 21],
  ["guitarras", 20],
  ["electroambient", 19],
  ["folkpop", 19],
  ["indiepop", 19],
  ["ska", 19],
  ["acousticrock", 18],
  ["contemporary", 17],
  ["dubelectro", 17],
  ["neoclassical", 17],
  ["chilloutlounge", 16],
  ["medieval", 16],
  ["ragga", 16],
  ["darkelectro", 15],
  ["electronik", 15],
  ["emo", 15],
  ["gipsy", 15],
  ["hardtrance", 15],
  ["electrodance", 14],
  ["jazzfusion", 14],
  ["middleeastern", 14],
  ["progressiverock", 14],
  ["rocknroll", 14],
  ["britpop", 13],
  ["electrojazz", 13],
  ["march", 13],
  ["freejazz", 12],
  ["gangsta", 12],
  ["breakcore", 11],
  ["dreampop", 11],
  ["glitch", 11],
  ["computermusic", 10],
  ["glam", 10],
  ["popfunk", 10],
  ["punkrock", 10],
  ["chansonatexte", 9],
  ["dancemusic", 9],
  ["downbeat", 9],
  ["ambientmusic", 8],
  ["electronical", 8],
  ["samba", 8],
  ["abstracthiphop", 7],
  ["idm", 6],
  ["latino", 6],
  ["psytrance", 6],
  ["dancehouse", 5],
  ["electronicmusic", 5],
  ["experimentalrock", 5],
  ["prog", 5],
  ["rhythmandblues", 5],
  ["smoothjazz", 5],
  ["soul", 5],
  ["christianrap", 4],
  ["countryrock", 4],
  ["doom", 4],
  ["reggaeton", 4],
  ["rockandroll", 4],
  ["techhouse", 4],
  ["drone", 3],
  ["emocore", 3],
  ["grindcore", 3],
  ["hardtek", 3],
  ["jrock", 3],
  ["jungle", 3],
  ["opera", 3],
  ["poppunk", 3],
  ["ragtime", 3],
  ["rave", 3],
  ["soundtracks", 3],
  ["symphonic", 3],
  ["classicalmusic", 2],
  ["electronika", 2],
  ["electropunk", 2],
  ["island", 2],
  ["jazzrock", 2],
  ["metalcore", 2],
  ["noise", 2],
  ["postpunk", 2],
  ["powermetal", 2],
  ["rocksteady", 2],
  ["salsa", 2],
  ["souljazz", 2],
  ["soundscapes", 2],
  ["tango", 2],
  ["technoindustrial", 2],
  ["tribal", 2],
  ["deutschrock", 1],
  ["electronicambient", 1],
  ["elektro", 1],
  ["goth", 1],
  ["indierock", 1],
  ["indietronica", 1],
  ["krautrock", 1],
  ["loungemusic", 1],
  ["manouche", 1],
  ["progressivehouse", 1],
  ["rockfrancais", 1],
  ["swing", 1],
  ["tecno", 1],
  ["trip", 1],
];

export const INSTRUMENTS_WITH_COUNT: [string, number][] = [
  ["piano", 62],
  ["guitar", 20],
  ["violin", 14],
  ["acousticguitar", 9],
  ["accordion", 8],
  ["pianosolo", 8],
  ["clarinet", 6],
  ["computer", 6],
  ["bass", 4],
  ["electricguitar", 3],
  ["electricpiano", 3],
  ["flute", 3],
  ["bells", 2],
  ["cello", 2],
  ["drum", 2],
  ["drums", 2],
  ["guitare", 2],
  ["orchestra", 2],
  ["synthesizer", 2],
  ["ukulele", 2],
  ["acousticbassguitar", 1],
  ["batterie", 1],
  ["cymbal", 1],
  ["doublebass", 1],
  ["oud", 1],
  ["panflute", 1],
  ["sampler", 1],
  ["synth", 1],
  ["viola", 1],
];

/** autotagging_instrument.tsv 中在 raw.tsv 未出现的乐器，补全为 41 个，数量计 0 参与倒序 */
const EXTRA_INSTRUMENTS: string[] = [
  "beat", "bell", "bongo", "brass", "classicalguitar", "drummachine",
  "harmonica", "harp", "horn", "keyboard", "oboe", "organ", "pad",
  "percussion", "pipeorgan", "rhodes", "saxophone", "strings",
  "trombone", "trumpet", "voice",
];

export const MOODS_THEMES_WITH_COUNT: [string, number][] = [
  ["dream", 39],
  ["christmas", 23],
  ["love", 17],
  ["meditative", 15],
  ["film", 14],
  ["adventure", 8],
  ["relaxation", 4],
  ["advertising", 2],
  ["comedy", 2],
  ["corporate", 2],
  ["energy", 2],
  ["happy", 2],
  ["retro", 2],
  ["beach", 1],
  ["business", 1],
  ["celebration", 1],
  ["child", 1],
  ["children", 1],
  ["cinema", 1],
  ["commercial", 1],
  ["dark", 1],
  ["darkness", 1],
  ["dynamic", 1],
  ["energetic", 1],
  ["holiday", 1],
  ["hypnotic", 1],
  ["indian", 1],
  ["life", 1],
  ["melodic", 1],
  ["poesia", 1],
  ["quiet", 1],
  ["sexy", 1],
  ["silence", 1],
  ["space", 1],
  ["spiritual", 1],
  ["tv", 1],
];

function tagsSortedByCountDesc(withCount: [string, number][], extraTags: string[] = []): string[] {
  const byTag = new Map(withCount.map(([t, c]) => [t, c]));
  for (const t of extraTags) {
    if (!byTag.has(t)) byTag.set(t, 0);
  }
  return [...byTag.entries()]
    .sort((a, b) => b[1] - a[1])
    .map(([t]) => t);
}

/** 冷启动/标签选择用：所有出现过的 tag，每类按歌曲数量倒序，不限制数量 */
export function getReportDistinctTags(): {
  genres: string[];
  instruments: string[];
  moods: string[];
  themes: string[];
} {
  return {
    genres: tagsSortedByCountDesc(GENRES_WITH_COUNT),
    instruments: tagsSortedByCountDesc(INSTRUMENTS_WITH_COUNT, EXTRA_INSTRUMENTS),
    moods: tagsSortedByCountDesc(MOODS_THEMES_WITH_COUNT),
    themes: tagsSortedByCountDesc(MOODS_THEMES_WITH_COUNT),
  };
}
